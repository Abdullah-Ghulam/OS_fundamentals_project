import matplotlib.pyplot as plt
from tabulate import tabulate

# Priority Ø®ÙˆØ±Ø§Ø²Ù…ÙŠØ©
def priority_scheduling(processes):
    #ØªÙ†Ø¸ÙŠÙ… Ø¹Ù„Ù‰ Ø§Ø³Ø§Ø³ Ø§Ù„Ø§ÙˆÙ„ÙˆÙŠØ©
    processes.sort(key=lambda x: x['priority'])

    print("\nProcess Execution Order based on Priority Scheduling:")
    total_wait_time = 0
    total_turnaround_time = 0
    time_elapsed = 0

    process_table = []  # ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§ Ø¹Ù„Ù‰ Ø´ÙƒÙ„ Ø¬Ø¯ÙˆÙ„

    process_names = []
    start_times = []
    burst_times = []
    turnaround_times = []

    for process in processes:
        # Ø­Ø³Ø§Ø¨ wait time Ùˆ turnaround time
        wait_time = time_elapsed
        turnaround_time = wait_time + process['burst_time']

        total_wait_time += wait_time
        total_turnaround_time += turnaround_time

        # ØªÙˆØµÙŠÙ„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¨Ø±ÙˆØ³ÙŠØ³ Ø§Ù„Ù‰ Ø§Ù„Ø¬Ø¯ÙˆÙ„
        process_table.append([process['name'], process['burst_time'], wait_time, turnaround_time])

        # ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª Ø¨Ø´ÙƒÙ„ Ù…Ø³ØªÙ…Ø±
        process_names.append(process['name'])
        start_times.append(time_elapsed)
        burst_times.append(process['burst_time'])
        turnaround_times.append(turnaround_time)
        time_elapsed += process['burst_time']

    avg_wait_time = total_wait_time / len(processes)
    avg_turnaround_time = total_turnaround_time / len(processes)

    # Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù„Ù‰ Ø´ÙƒÙ„ Ø¬Ø¯ÙˆÙ„
    print(tabulate(process_table, headers=["ğŸ”¤ Process", "â²ï¸ Burst Time   ", "â±ï¸ Waiting Time   ", "â³ Turnaround Time   "], tablefmt="grid"))
    print(f"\nğŸ•’ Average Waiting Time: {avg_wait_time:.2f}")
    print(f"â³ Average Turnaround Time: {avg_turnaround_time:.2f}")

    # ØªØµÙˆÙŠØ± Ø§Ù„Ø¨Ø±ÙˆØ³ÙŠØ³ Ø¹Ù„Ù‰ Ø´ÙƒÙ„ Gantt-Chart
    plt.figure(figsize=(14, 2))

    # Ø¹Ø±Ø¶ Gantt-Chart
    for i, process in enumerate(process_names):
        plt.barh(0.4, burst_times[i], left=start_times[i], color='lightblue', edgecolor='black', height=0.8)
        plt.text(start_times[i] + burst_times[i] / 2, 0.4, process, ha='center', va='center', color='black', fontsize=30)
    # Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙˆÙ‚Øª ÙÙŠ Ø§Ù„Ø´ÙƒÙ„
    for start, burst in zip(start_times, burst_times):
        plt.text(start, -0.2, f"{start}", ha='center', va='center', fontsize=25)
    plt.text(start_times[-1] + burst_times[-1], -0.2, f"{start_times[-1] + burst_times[-1]}", ha='center', va='center', fontsize=25)

    plt.yticks([])
    plt.xticks([])
    plt.title('Gantt Chart - Priority Scheduling')
    plt.tight_layout()
    plt.show()

# Main function
def main():
    processes = []
    num_processes = int(input(" \"â­ priority scheduling Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ø§Ù„Ø§ÙˆÙ„ÙˆÙŠØ© â­\" \n \n Enter the number of processes: "))

    for i in range(num_processes):
        name = f"P{i + 1}"
        print(f"\nProcess {name}:")
        priority = int(input(f"ğŸ”¢ Enter priority : "))
        burst_time = int(input(f"â²ï¸ Enter burst time : "))
        processes.append({'name': name, 'priority': priority, 'burst_time': burst_time})

    priority_scheduling(processes)

if __name__ == "__main__":
    main()
